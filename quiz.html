<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>StudyHelper | Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial;
  margin:0;
  padding:15px;
  background:linear-gradient(135deg,#667eea,#764ba2);
  min-height:100vh;
}
.card{
  background:#fff;
  padding:15px;
  border-radius:12px;
  max-width:600px;
  margin:auto;
}
.choice{
  padding:8px;
  border:1px solid #ccc;
  border-radius:6px;
  margin-bottom:6px;
  cursor:pointer;
}
.choice:hover{background:#eee}
.choice.selected{background:#c8e6c9}
.timer{color:#f44336;font-weight:bold}
input{
  width:100%;
  padding:8px;
  margin-bottom:6px;
}
button{
  padding:8px 12px;
  border:none;
  border-radius:6px;
  background:#4caf50;
  color:white;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="card">
  <h2 id="quizTitle">ðŸ§  Quiz</h2>
  <div class="timer" id="timer">Time: 60</div>

  <div id="questionBox"></div>
  <div id="choices"></div>

  <button id="nextBtn">Next</button>
</div>

<script>
/* ---------------- VARIABLES ---------------- */
let questions=[];
let current=0;
let score=0;
let selected=null;
let time=60;

/* ---------------- TIMER ---------------- */
const timerEl=document.getElementById("timer");
setInterval(()=>{
  time--;
  timerEl.textContent="Time: "+time;
  if(time<=0) finishQuiz();
},1000);

/* ---------------- SAMPLE NOTE ---------------- */
/* para gumana kahit walang firebase */
const noteText = `
Database systems store, manage, and retrieve large amounts of data.
They are used in schools, hospitals, and businesses.
Important terms include tables, records, fields, and queries.
`;

/* ---------------- GENERATE QUIZ ---------------- */
function generateQuiz(text){
  const clean=text.toLowerCase().replace(/[^a-z ]/g,"");
  const words=[...new Set(clean.split(" ").filter(w=>w.length>5))];

  // Multiple choice (3)
  for(let i=0;i<3;i++){
    const answer=words[Math.floor(Math.random()*words.length)];
    const choices=shuffle([
      answer,
      randomWord(words),
      randomWord(words),
      randomWord(words)
    ]);
    questions.push({
      type:"mc",
      q:"Which word appeared in the note?",
      choices,
      answer
    });
  }

  // Enumeration (1)
  questions.push({
    type:"enum",
    q:"List THREE important terms mentioned in the note.",
    answers:shuffle(words).slice(0,3)
  });
}

function randomWord(arr){
  return arr[Math.floor(Math.random()*arr.length)];
}
function shuffle(arr){
  return arr.sort(()=>Math.random()-0.5);
}

/* ---------------- SHOW QUESTION ---------------- */
function showQuestion(){
  const q=questions[current];
  const qBox=document.getElementById("questionBox");
  const choicesBox=document.getElementById("choices");
  qBox.innerHTML=`<h3>${q.q}</h3>`;
  choicesBox.innerHTML="";
  selected=null;

  if(q.type==="mc"){
    q.choices.forEach(c=>{
      const div=document.createElement("div");
      div.className="choice";
      div.textContent=c;
      div.onclick=()=>{
        document.querySelectorAll(".choice").forEach(x=>x.classList.remove("selected"));
        div.classList.add("selected");
        selected=c;
      };
      choicesBox.appendChild(div);
    });
  }

  if(q.type==="enum"){
    for(let i=0;i<3;i++){
      const input=document.createElement("input");
      input.placeholder="Answer "+(i+1);
      choicesBox.appendChild(input);
    }
  }
}

/* ---------------- NEXT BUTTON ---------------- */
document.getElementById("nextBtn").onclick=()=>{
  const q=questions[current];

  if(q.type==="mc" && selected===q.answer) score++;

  if(q.type==="enum"){
    const inputs=[...document.querySelectorAll("input")].map(i=>i.value.toLowerCase());
    let correct=0;
    q.answers.forEach(a=>{
      if(inputs.includes(a)) correct++;
    });
    if(correct>=2) score++;
  }

  current++;
  if(current<questions.length){
    showQuestion();
  }else{
    finishQuiz();
  }
};

/* ---------------- FINISH ---------------- */
function finishQuiz(){
  document.querySelector(".card").innerHTML=`
    <h2>Quiz Finished ðŸŽ‰</h2>
    <p>Score: ${score} / ${questions.length}</p>
  `;
}

/* ---------------- START ---------------- */
generateQuiz(noteText);
showQuestion();
</script>

</body>
</html>
