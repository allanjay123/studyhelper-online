<script type="module">
  import { auth } from "./firebase.js";
  import {
    signInWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

  const loginBtn = document.getElementById("loginBtn");
  const logoutBtn = document.getElementById("logoutBtn");

  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const loginMsg = document.getElementById("loginMsg");

  loginBtn.onclick = async () => {
    loginMsg.textContent = "Logging in...";
    try {
      await signInWithEmailAndPassword(
        auth,
        emailInput.value,
        passwordInput.value
      );
    } catch (e) {
      loginMsg.textContent = e.message;
    }
  };

  onAuthStateChanged(auth, user => {
    if (user) {
      document.getElementById("loginCard").classList.add("hidden");
      document.getElementById("dashboard").classList.remove("hidden");
      document.getElementById("userEmail").textContent = user.email;
    } else {
      document.getElementById("dashboard").classList.add("hidden");
      document.getElementById("loginCard").classList.remove("hidden");
    }
  });

  logoutBtn.onclick = () => signOut(auth);
</script>
