<!DOCTYPE html>  <html lang="en">    <head>    
<meta charset="UTF-8">    
<title>StudyHelper | Home</title>    
<meta name="viewport" content="width=device-width, initial-scale=1.0">  <style>    
body{    
  margin:0;    
  font-family:Arial;    
  background:linear-gradient(135deg,#667eea,#764ba2);    
  min-height:100vh;    
}    
header{    
  background:#fff;    
  padding:10px 20px;    
  display:flex;    
  justify-content:space-between;    
  align-items:center;    
}    
.container{    
  max-width:1200px;    
  margin:20px auto;    
  padding:10px;    
}    
.grid{    
  display:grid;    
  grid-template-columns:2fr 1fr;    
  gap:15px;    
}    
.card{    
  background:#fff;    
  padding:15px;    
  border-radius:12px;    
  margin-bottom:15px;    
}    
input,textarea{    
  width:100%;    
  padding:8px;    
  margin-bottom:8px;    
}    
button{    
  padding:8px 12px;    
  border:none;    
  border-radius:6px;    
  background:#4caf50;    
  color:white;    
  cursor:pointer;    
}    
button.delete{    
  background:#f44336;    
  font-size:12px;    
  margin-left:6px;    
}    
.lesson,.task{    
  display:flex;    
  align-items:center;    
  gap:8px;    
  margin-bottom:6px;    
}    
.lesson.done,.task.done{    
  text-decoration:line-through;    
  color:#777;    
}    
.progress{    
  background:#ddd;    
  height:8px;    
  border-radius:5px;    
  overflow:hidden;    
  margin-top:6px;    
}    
.progress div{    
  background:#4caf50;    
  height:100%;    
}    
.subject-box{    
  border-bottom:1px solid #eee;    
  padding-bottom:10px;    
  margin-bottom:10px;    
}    
.subject-header{    
  display:flex;    
  justify-content:space-between;    
  align-items:center;    
}    
</style>  </head>  <body>  <header>    
  <strong>StudyHelper</strong>    
  <div>    
    <button onclick="location.href='subjects.html'">ðŸ“š Subjects</button>    
    <button onclick="location.href='calendar.html'">ðŸ“… Calendar</button>    
    <button id="logout">Logout</button>    
  </div>    
</header>  <div class="container">    
<div class="grid">  <!-- LEFT -->  <div>  <div class="card">    
<h3>Add Note</h3>    
<input id="noteTitle" placeholder="Title">    
<textarea id="noteBody" placeholder="Your note"></textarea>    
<button id="saveNote">Save Note</button>    
</div>  <div class="card">    
<h3>Your Notes</h3>    
<div id="notesList"></div>    
</div>  <div class="card">    
<h3>Tasks</h3>    
<input id="taskInput" placeholder="New task">    
<button id="addTask">Add Task</button>    
<div id="tasksList"></div>    
</div>  </div>  <!-- RIGHT -->  <div>  <div class="card">    
<h3>ðŸ“Š Subjects Mastery</h3>    
<div id="subjectsMastery"></div>    
</div>  <div class="card">    
<h3>ðŸ“˜ Lessons</h3>    
<div id="lessonsList"></div>    
</div>  </div>  </div>    
</div>  <script type="module">    
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";    
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";    
import {    
  getFirestore,    
  collection,    
  addDoc,    
  onSnapshot,    
  deleteDoc,    
  doc,    
  updateDoc,    
  getDocs    
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";    /* FIREBASE CONFIG */
const firebaseConfig = {
apiKey: "AIzaSyCk3YyAne_nz0fwChI6557R8RtcmlMAawA",
authDomain: "studyhelper-app.firebaseapp.com",
projectId: "studyhelper-app"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
let uid;

/* AUTH */
onAuthStateChanged(auth,user=>{
if(!user) location.href="index.html";
uid=user.uid;
loadNotes();
loadTasks();
loadSubjects();
});
logout.onclick=()=>signOut(auth);

/* NOTES */
saveNote.onclick = async ()=>{
if(!noteTitle.value || !noteBody.value) return;
await addDoc(collection(db,"users",uid,"notes"),{
title:noteTitle.value,
body:noteBody.value
});
noteTitle.value="";
noteBody.value="";
};

function loadNotes(){
onSnapshot(collection(db,"users",uid,"notes"),snap=>{
notesList.innerHTML="";
snap.forEach(d=>{
const div=document.createElement("div");
div.innerHTML=<strong>${d.data().title}</strong><p>${d.data().body}</p>;
const del=document.createElement("button");
del.textContent="Delete";
del.className="delete";
del.onclick=()=>deleteDoc(doc(db,"users",uid,"notes",d.id));
div.appendChild(del);
notesList.appendChild(div);
});
});
}

/* TASKS (NO PROGRESS) */
addTask.onclick = async ()=>{
if(!taskInput.value) return;
await addDoc(collection(db,"users",uid,"tasks"),{
text:taskInput.value,
done:false
});
taskInput.value="";
};

function loadTasks(){
onSnapshot(collection(db,"users",uid,"tasks"),snap=>{
tasksList.innerHTML="";
snap.forEach(d=>{
const t=d.data();
const row=document.createElement("div");
row.className="task"+(t.done?" done":"");

const cb=document.createElement("input");    
  cb.type="checkbox";    
  cb.checked=t.done;    
  cb.onchange=()=>updateDoc(    
    doc(db,"users",uid,"tasks",d.id),    
    {done:cb.checked}    
  );    

  const del=document.createElement("button");    
  del.textContent="X";    
  del.className="delete";    
  del.onclick=()=>deleteDoc(doc(db,"users",uid,"tasks",d.id));    

  row.append(cb,t.text,del);    
  tasksList.appendChild(row);    
});

});
}

/* SUBJECTS + LESSONS (DELETE FIXED) */
function loadSubjects(){
onSnapshot(collection(db,"users",uid,"subjects"),snap=>{
subjectsMastery.innerHTML="";
lessonsList.innerHTML="";

snap.forEach(s=>{    
  const sid=s.id;    
  const sName=s.data().name;    

  const box=document.createElement("div");    
  box.className="subject-box";    

  const header=document.createElement("div");    
  header.className="subject-header";    

  const title=document.createElement("strong");    
  title.textContent=sName;    

  const delSub=document.createElement("button");    
  delSub.textContent="Delete";    
  delSub.className="delete";    
  delSub.onclick=async()=>{    
    const ls=await getDocs(    
      collection(db,"users",uid,"subjects",sid,"lessons")    
    );    
    ls.forEach(l=>deleteDoc(l.ref));    
    await deleteDoc(doc(db,"users",uid,"subjects",sid));    
  };    

  header.append(title,delSub);    
  box.appendChild(header);    

  onSnapshot(    
    collection(db,"users",uid,"subjects",sid,"lessons"),    
    ls=>{    
      let done=0,total=ls.size;    

      ls.forEach(l=>{    
        const d=l.data();    
        if(d.completed) done++;    

        const row=document.createElement("div");    
        row.className="lesson"+(d.completed?" done":"");    

        const cb=document.createElement("input");    
        cb.type="checkbox";    
        cb.checked=d.completed;    
        cb.onchange=()=>updateDoc(    
          doc(db,"users",uid,"subjects",sid,"lessons",l.id),    
          {completed:cb.checked}    
        );    

        const del=document.createElement("button");    
        del.textContent="X";    
        del.className="delete";    
        del.onclick=()=>deleteDoc(    
          doc(db,"users",uid,"subjects",sid,"lessons",l.id)    
        );    

        row.append(cb,`${sName}: ${d.title}`,del);    
        lessonsList.appendChild(row);    
      });    

      const percent=total?Math.round((done/total)*100):0;    
      const progress=document.createElement("div");    
      progress.className="progress";    
      const bar=document.createElement("div");    
      bar.style.width=percent+"%";    
      progress.appendChild(bar);    

      box.appendChild(progress);    
      subjectsMastery.appendChild(box);    
    }    
  );    
});

});
}
</script>  </body>

</html>    
